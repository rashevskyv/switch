---
permalink: /update-fw.html
title: Безопасное обновление прошивки 
author_profile: true
---
{% include toc title="Разделы" %}

Нижеследующая инструкция подходит для обновления системного ПО в Atmosphere, то есть в пиратской прошивке вне зависимости от того в {% include abbr/sysnand.txt abbr="SysNAND" %} она у вас установлена, или в {% include abbr/emunand.txt abbr="EmuNAND" %}. Если вам нужно обновить системное ПО в официальной прошивке, вы можете сделать это через **Системные настройки** приставки, то есть официальным способом. Помните, что если у вас стоит [AutoRCM](autorcm){:target="_blank"}, то обновление прошивки официальным способом, удалит его. Чтобы его сохранить, обновляйтесь через Semi-Stock через Daybreak методом, указанном ниже, или через настройки. Это безопасно.
{: .notice--info}

{% capture notice-5 %}
## Выберите эксплойт, который используете для активации взлома 

* **Fusée Gelée** подразумевает взлом через аппаратную уязвимость. Если для запуска прошивки вы используете {% include abbr/host.txt abbr="хост" %}, то у вас определённо Fusée Gelée
* **Caffeine** подразумевает взлом через программную уязвимость в браузере. Если для запуска взлома вы запускаете браузер, то у вас определённо Caffeine

<div class="select_fw__wrapper">
	<div class="select_fw">
	    <input type="radio" id="button1" name="exploit" value="button1" checked />
	    <label for="button1">Fusée Gelée</label>
	    <input type="radio" id="button0" name="exploit" value="button0" />
	    <label for="button0">SX Core / SX Lite или их аналоги</label>
	    <input type="radio" id="button2" name="exploit" value="button2" />
	    <label for="button2">Caffeine</label>
	</div>
</div>

<!--В данный момент последней прошивкой является {% include /vars/sys_version.txt %}, однако, поскольку она только вышла и недостаточно оттестирована, а так же потому что ещё нет игр требующих её, не рекомендуется пока на неё обновляться. Если же вы уже на ней установите рекомендуемую прошивку по инструкции ниже!
{: .notice--warning}-->

<!-- {% spoiler Видеоинструкция %}

{% include youtube.html id="I6R_XaYt7ps" %}
{: .text-center}
{: .notice--info}

{% endspoiler %}-->
{% endcapture %}

<div id="selector">{{ notice-5 | markdownify }}</div> 

## Важная информация

Это же руководство подходит и для понижения прошивки. Помните, что в случае понижения прошивки есть шанс, что пониженная прошивка не запустится. В таком случае вам будет необходимо [восстанавливать прошивку вручную](downgrade_fw). **Обязательно** [делайте бекап](backup-nand){:target="_blank"}, прежде чем понижать прошивку!. 

Обязательно следуйте инструкции именно в том порядке, в котором она написана: сперва обновление кефира, затем обновление системного ПО! Иначе, приставка просто не запустится. Если по какой-то нелепой причине, вы обновили системное ПО, но не обновили кефир, обновите кефир!
{: .notice--warning}

## Теоретическая часть

Если вы хотите получить поддержку {% include abbr/exfat.txt %} или {% include abbr/sdhc.txt %}, полностью следуйте этому руководству, даже если у вас и так уже последняя прошивка. Действия для активации {% include abbr/exfat.txt %}, {% include abbr/sdhc.txt %} и для поднятия прошивки идентичный! Да, нужно делать, даже если у вас уже и так {% include /vars/update_version.txt %}
{: .notice--warning}

При прошивке на некоторые версии (1.0.0, 2.0.0, 5.0.0, 6.0.0, 6.2.0, 7.0.0) приставка сжигает специальные предохранители на чипе, чтобы по их состоянию отслеживать версию системного ПО на вашей приставке. В обычном режиме при установке прошивки, консоль проверяет количество сожжённых предохранителей. Если это количество больше, чем требуется для прошивки, то консоль понимает, что вы пытаетесь установить прошивку ниже, чем была установлена до этого, и не позволит это сделать. Если же количество сожжённых предохранителей ниже, чем требует устанавливаемая прошивка, то прошивка разрешается и в ходе неё сжигается столько предохранителей сколько необходимо, чтобы соответствовать указанному в прошивке количеству. Таким образом, если вы обновились до {% include /vars/update_version.txt %} официально, у вас на приставке будет сожжено 12 предохранителей. Если вы попытаетесь восстановить бекап, скажем, сделанный на прошивке 8.1.0, для работы которой требуется 10 предохранителей (а у вас сожжено 12), то приставка поймёт это и официальная прошивка не запустится!

**Количество сожжённых предохранителей не важно для кастомных прошивок. Вы сможете откатиться на любую прошивку при условии использования кастомного загрузчика.** Официальная же прошивка не запустится, если версия установленной прошивки ниже, чем на то указывают предохранители. Если выше, то OFW сожжёт предохранители, чтобы они соответствовали запущенной версии прошивки.

По этой инструкции можно менять версию своего ПО на любую, а не только на {% include /vars/update_version.txt %}. 

## Что понадобится

* Свежая версия {% include abbr/kefir_addr.txt %}
* [Прошивка **{% include /vars/update_version.txt %}**](https://darthsternie.net/switch-firmwares/){:target="_blank"}
* Карта памяти 

## Инструкция

### Часть I - Резервное копирование NAND

Пропустите эту часть, если у вас уже есть резервная копия!

Если резервной копии нет, эту часть нужно делать **обязательно**!
{: .notice--danger}

1. Создайте [резервную копию NAND](backup-nand){:target="_blank"} консоли и поместите её в надёжное место 

### Часть II - Подготовка к обновлению
**Важная информация!!** Используйте карты памяти только с файловой системой FAT32!
{: .notice--warning}

1. Выключите Switch и вставьте его карту памяти в ПК 
	* **Внимание!** Перед обновлением перейдите в папку `atmosphere/contents` и удалите следующие папки с карты памяти, если таковые имеются:
		* `0100000000001000`
		* `0100000000001013`
		* `0100000000000352`
1. Установите {% include abbr/kefir_addr.txt %}, если ещё не делали этого
	* Если версия вашего системного ПО 1.0.0, удалите папки `\atmosphere\exefs_patches` и `\atmosphere\kip_patches\fs_patches`:
		* После того, как вы удачно обновите системное ПО, обязательно **ещё раз установите {% include abbr/kefir_addr.txt %}**
1. Распакуйте архив `{% include /vars/update_version.txt %}.zip` в папку `firmware`на карте памяти вашей приставки (если её нет, создайте)
	* Ещё раз - архив **с прошивкой**. Не архив с кефиром! Архив с прошивкой расположен в части [Что понадобится](#что-понадобится). Нужно скопировать не сам архив, а именно его **содержимое**
	* Вместо этого вы можете скачать архив со свежей версией системного ПО через приложение **Kefir Updater** прямо на вашей приставке. Для этого запустите [HBL](hbl){:target="_blank"} через игру, выберите приложение **Kefir Updater**, перейдите в меню "**Скачать прошивку**" и выбекрите необходимую версию. Нажмите (A), нажмите "**Продолжить**", чтобы начать закачку прошивки. Программа сама скачает выбранную версию системного ПО и распакует её в папку `firmware`. 
1. Вставьте карту памяти обратно в приставку

### Часть III - Обновление прошивки

{% capture notice-2 %}

<!-- Caffeine -->
{% capture notice-3 %}
**Обязательно убедитесь, что находитесь в EmuNAND**, если поднимаете версию вашего системного ПО. Для этого перейдите в **Системные настройки** -> **Система**. В строке ниже **Обновления системы** будет написана версия вашего системного ПО, версия Atmosphere и буква **S** или **E**, где **S** будет означать *SysNAND*, а **E** - *EmuNAND*. 

![](/images/screenshots/atmo_emu.png)
{: .text-center}
{: .notice--info}

* Если вы случайно обновите SysNAND до последней версии системного ПО, то любая загрузка в официальную прошивку сделает прошивку через Caffeine невозможной и вам придётся чиповать приставку!
{% endcapture %}
<div class="notice--warning">{{ notice-3 | markdownify }}</div>

{% endcapture %}
<div class="hideble button2 hide">{{ notice-2 | markdownify }}</div>

<!-- Fusée Gelée -->
1. Запустите [{% include abbr/cfw.txt abbr="кастом" %}](cfw){:target="_blank"}
	* Если после логотипа Nintendo вы наблюдаете чёрный экран с ошибкой, значит у вас не установлены драйвера exFAT и вы проигнорировали [форматирование карты памяти в FAT32](https://format.customfw.xyz){:target="_blank"}, которое нужно было сделать выше
1. Откройте [Homebrew Launcher](hbl){:target="_blank"}
1. Запустите **Daybreak** и выберите **Install**
1. Перейдите в папку `firmware`, в ней находится прошивка {% include /vars/update_version.txt %}, скопированная ранее, и нажмите (A)
	* Если вы не можете перейти в папку (папка отображается как файл), значит ваша папка имеет неверные атрибуты (чаще всего архивный). Как их исправить описано в [FAQ](faq){:target="_blank"} или разделе [проблемы и их решения](troubleshooting){:target="_blank"}
1. Дождитесь окончания обработки прошивки и нажмите "**Continue**"
1. Нажмите "**Preserve settings**".
	* Если вы хотите сбросить приставку к заводским настройкам после обновления, нажмите "**Reset to factory settings**". При обычном обновлении на нее **не нужно нажимать**!
1. Нажмите "**Continue**", чтобы начать установку
1. После окончания установки нажмите "**Reboot**" для перезагрузки, или "**Shutdown**", чтобы выключить приставку 

Вы можете удалить папку с прошивкой {% include /vars/update_version.txt %} с карты памяти. Она нам больше не нужна
{: .notice--info}

<!-- Caffeine -->
{% capture notice-2 %}
### Часть IV - AutoRCM

AutoRCM - на консоли специальным образом изменяется загрузочный сектор, вследствие чего консоль не может загрузиться прямо в систему и загружается автоматически в режим RCM. Достаточно просто включить консоли и она автоматически попадёт в режим восстановления. Не нужно зажимать комбинацию кнопок и использовать замыкатель, но пейлоад для запуска прошивки всё равно передавать нужно!
{: .notice--info}

Для приставок прошитых через Caffeine, использовать AutoRCM **НЕЛЬЗЯ**! Это **гарантированно** приведёт к брику приставки! 
{: .notice--danger}

1. Находясь в {% include abbr/hekate.txt abbr="hekate" %} перейдите в раздел **Tools**
1. Выберите раздел **Arch bit • RCM • Touch • Partitions**, находящийся внизу экрана справа
1. Убедитесь, что возле **AutoRCM** стоит **OFF**
	* Если это не так, переведите **AutoRCM** в состояние **OFF**, нажав на **AutoRCM**, затем **OK**

{% endcapture %}
<div class="hideble button2 hide">{{ notice-2 | markdownify }}</div>

## Важно знать

* Если после прошивки вам предложат обновить контроллеры - обновляйте
* Если после обновления у вас чёрный экран после логотипа Nintendo, обновите {% include abbr/kefir_addr.txt %}
	* Если не помогло, прочтите внимательно разделы [Проблемы и их решения](troubleshooting){:target="_blank"} и [FAQ](faq){:target="_blank"}
* Если приставка не загружается после прошивки (падает с ошибкой, например), [восстановите бекап](backup-nand#%D0%B2%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B9-%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8){:target="_blank"} или [восстанавливайте прошивку вручную](downgrade_fw){:target="_blank"}

## Возможные ошибки

{% spoiler При запуске Emunand ошибка "Failed to match warmboot with fuses" %}

Нажмите кнопку (POWER), чтобы запустить прошивку и [обновите](update-fw){:target="_blank"} {% include abbr/emunand.txt abbr="EmuNAND" %} до актуальной версии системного ПО

{% endspoiler %}

___

[Закрыть страницу](javascript:window.close();)
{: .notice--success}

<script>
	fuse = localStorage.getItem('fuse');
	caffeine = localStorage.getItem('caffeine');

	if (fuse == "1") {
		document.getElementById('selector').classList.add('hide');
		
	}

	if (caffeine == "1") {
		document.getElementById('selector').classList.add('hide');
		// $('div.button2').addClass('show')
		document.getElementsByClassName('button2')[0].classList.add('show')
		document.getElementsByClassName('button2')[0].classList.remove('hide')
		document.getElementsByClassName('button2')[1].classList.add('show')
		document.getElementsByClassName('button2')[1].classList.remove('hide')
	}

	localStorage.clear();
</script>